<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0"> -->
    <!-- Cette Meta vienn de Bootstrap et comporte une valeur supplémentaire "Shrink-to-fit=no" cela concerne les mobile -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>JS - VIII 04 - Formulaire</title>
    <!-- CSS de Bootstap  -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <!-- <script src="06-selecteurs.js" ></script> MON SCRIPT -->
    <!-- Mes Styles -->
    <style>
        .error {
            border: 2px solid red;
        }
        .valide { 
           border: 2px solid lightgreen;
        }
    </style>
    <!-- <script src=".js" async></script> -->
</head>
    <body>
        <section class="jumbotron"> 
            <!-- En-tête typique de bootstrap -->
            <h1 class="display-4 text-center" id="titreNiveau1">JS - VIII 04 - Formulaire</h1>
            <p class="lead ma-classe text-center">Un formulaire</p>
        </section>
        <div class="container border border-primary p-4">
            <div class="row border border-danger  m-2 p-2"> <!-- row -->
                <div class="col-6">
                    <h2> Fonction ControleForm()</h2>               
                </div> <!-- fin de col -->
                <div class="col-6">
                    <form action="formulaire" method="GET" name="formulaire" class="form-inline" >
                        <div class="form-group m-1">
                            <label for="pseudo" class="sr-only">Pseudo</label>
                            <input type="text" name="pseudo" id="pseudo" placeholder="Votre Pseudo" class="form-control">
                        </div>
                        <div class="form-group m-1">
                            <label for="mdp" class="sr-only">Mot de passe</label>
                            <input type="password" name="mdp" id="mdp" placeholder="Votre mot de passe" class="form-control">
                        </div>
                        <button type="submit" id="submit" value="ok" class="btn btn-primary" onclick="controleForm()">Envoyer</button>
                    </form>
                </div>
            </div> <!-- fin de row -->
            <div class="row">
                <div class="col-4">
                    <h2>Nouvelle fonction inscriptionForme2()</h2>
                </div> <!-- fin de col -->
                <div class="col-8 border border-success">
                    <form action="inscription" method="GET" name="inscription" id="form_inscription">
                        <div class="form-group">
                            <label for="prenom">Prénom *</label>
                            <input type="text" name="prenom" id="prenom" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="nom">Nom *</label>
                            <input type="text" name="nom" id="nom" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="email">Email *</label>
                            <input type="email" name="email" id="email" class="form-control" required>
                        </div>
                        <div class="form-group">
                            <label for="mdp">Mot de passe *</label>
                            <input type="password" name="mdp_2" id="mdp_2" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="confmdp">Confirmer le mot de passe *</label>
                            <input type="password" name="confmdp" id="confmdp" class="form-control">
                        </div>
                        <button type="submit" id="submit_2" value="inscription" class="btn btn-outline-success">S'inscrire</button>
                        <button id="reset_form" value="inscription" class="btn btn-outline-danger">Reinitialisation</button>
                        <!-- <button type="reset" value="inscription" class="btn btn-outline-danger">Reinitialisation</button> -->
                    </form>
                </div> <!-- fin de col -->
            </div> <!-- fin de row -->   
        </div><!-- Fin de container -->
    <!-- Le JS de bootstrap est optionnel -->
    <!-- En 1er JQuery, puis Pepper.js et le Js Boostrap -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" integrity="sha384-w1Q4orYjBQndcko6MimVbzY0tgp4pWB4lZ7lr30WKz0vr/aWKhXdBNmNb5D92v7s" crossorigin="anonymous"></script>
    <!-- Mes scripts -->
    <script>
        //controle du formulaire 1 avec une fonction
        function controleForm() {
            //event veut dire évènement : 
            event.preventDefault();//pour empéché l'envoi du formulaire à enlever en prod !
            //Dans le document dans le formulaire dans pseudo de la valeur dans pseudo
            if(document.formulaire.pseudo.value.length < 5 || document.formulaire.pseudo.value.length > 15) {
                console.log(document.fomulaire.pseudo.value);
                alert('Le pseudo doit comporter entre 5 et 15 caractère');
            }
            if(document.formulaire.mdp.value.length < 5 || document.formulaire.mdp.value.length > 15) {
                console.log(document.fomulaire.mdp.value);
                alert('Le mot de passe doit comporter entre 5 et 15 caractère');
            }
        }
        //////////////////////////////////////////////////////////
        // CONTROLE DU FORMULAIRE D'INSCRIPTION AVEC LA FONCTION//
        //////////////////////////////////////////////////////////
    //récupération du formulaire par son id
    let formInscrip = document.getElementById('form_inscription');
    // console.log(formInscrip);
    //écoute l'envoie du formulaire 
    formInscrip.addEventListener('submit', inscriptionForm);
    //fonction pour traiter le formulaire
    function inscriptionForm(event) {
        //permet de ne pas envoyer le formulaire, pour ne pas rafraichir la page
        event.preventDefault(); //on trouve parfois "e" pour appeler "event"
        // console.log(event.target.prenom);//
                    ///////////////////////////////////////////////
                    //          https://regex101.com              /
                    //EXPRESSION REGULIERE POUR VALIDER LES EMAIL//
                    ///////////////////////////////////////////////
    let regex = /([a-z0-9](\.?|\_|\-))*@([a-z0-9]{2,})(\.[a-z]{2,}){1,}/;
    // let regex = new RegExp ("([a-z0-9](\.?|\_|\-))*@([a-z0-9]{2,})(\.[a-z]{2,}){1,}");
                        //////////////////////////
                        //RECUPERATION DES CHAMPS/
                        //////////////////////////
    let prenom = event.target.prenom.value,
        nom = event.target.nom.value,
        email = event.target.email.value,
        mdp_2 = event.target.mdp_2.value,
        confmdp = event.target.confmdp.value;
        console.log(prenom, nom, email, mdp_2, confmdp);
                /////////////////////////////////////////
                //CONDITION DE PRENOM ET NOM AVEC VERIF//
                /////////////////////////////////////////
    if(prenom !== '' || nom !== ''){ //PRENOM ET NOM NE SONT PAS VIDE//
        if(prenom.length < 2){
            //classList représente toute les classes de l'élément event.target
            //add ajoute une class à l'élément event.target
            // console.log(event.target.prenom.classList);
            event.target.prenom.classList.add("error");
            event.target.prenom.classList.remove("valide");
        } 
        else {
            event.target.prenom.classList.add("valide");
            event.target.prenom.classList.remove("error");
        }
        if (nom.length < 4){
            event.target.nom.classList.add("error");
            event.target.nom.classList.remove("valide");
        } 
        else {
            event.target.nom.classList.add("valide");
            event.target.nom.classList.remove("error");
        }
    }//FIN DE CONDITION PRENOM ET NOM//
                /////////////////////////////////
                // CONDITION DE MDP AVEC VERIF //
                /////////////////////////////////
        if(confmdp !== mdp_2){
            event.target.mdp_2.classList.add("error");
            event.target.mdp_2.classList.remove("valide");
            event.target.confmdp.classList.add("error");
            event.target.confmdp.classList.remove("valide");
        } 
        else if(mdp_2.length < 5 || mdp_2.length > 12){//LONGUEUR DU MDP ENTRE 5 ET 12
            event.target.mdp_2.classList.add("error");
            event.target.mdp_2.classList.remove("valide");
        } 
        else { //TOUT EST BON//
            event.target.mdp_2.classList.add("valide");
            event.target.mdp_2.classList.remove("error");
            event.target.confmdp.classList.add("vaide");
            event.target.confmdp.classList.remove("error");
        }
                /////////////////////////////////
                //CONDITION DE EMAIL AVEC VERIF//
                /////////////////////////////////
        // console.log(regex.test(email));
        if(regex.test(email) === false)  {
        //if(!regex.test(email){
            event.target.email.classList.add("error");
            event.target.email.classList.remove("valide");
        } else {
            event.target.email.classList.remove("error");
            event.target.email.classList.add("valide");
        } //FIN DE CONDITION EMAIL//
    }//FIN DE FONCTION//
    // document.getElementById("reset_form").addEventListener("click",(e)=> {
    // });
    document.getElementById("reset_form").addEventListener("click", function(event) {
        // console.log(event.target.form);
        event.target.form.prenom.value = "";
        event.target.form.nom.value = "";
        event.target.form.email.value = "";
        event.target.form.mdp_2.value = "";
        event.target.form.confmdp.value = "";
    });
    </script>
    </body>
</html>